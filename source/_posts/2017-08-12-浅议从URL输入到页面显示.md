---
title: 浅议从URL输入到页面显示
categories:
  - web
tags:
  - WEB
date: 2017-08-12 20:27:31
---

# 前言

作为一名前端从业人员，技能水平已经不再局限为切图、布局了，前端这个行业现在可以说涉猎非常广泛，所以，很多面试官在考察面试者知识体系的时候会问这样一个问题——“尽可能详细的说说从输入URL到页面呈现这个过程”。本文就作者目前的了解的相关知识来对这个问题做一下浅议。

# 输入URL

URL(Uniform Resource Locator)，又称统一资源定位符，常常又会被问到和URI(Uniform Resource Identifier)——统一资源标识符的区别。可以简单理解为URL是URI的一个子集，URI标志了一个资源，而URL不仅标志了这个资源，还附带了这个资源的位置信息。

标准的URI结构应该是如下这样的：

> scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]
> 协议://用户名:密码@子域名.域名.顶级域名:端口号/目录/文件名.文件后缀?参数=值#标志

由URI的结构我们还能很好的回答出另一个延伸的问题——同源策略，满足同源策略说白了就是保证协议、域名和端口都相同，参照URL结构应该能很好的理解这个定义。

# DNS解析

我们对于URL较为熟悉的应该算是其中的域名了，但是实际的传输中，辨认位置信息并不是靠的域名，而是IP地址，所以当我们输入了URL之后在实际进行信息传输之前还需要一个步骤，那就是把输入的域名转换为相对应的IP，这个过程叫做DNS解析。
DNS(Domain Name System)解析大致会经过如下几个过程：

+ 查询浏览器端的DNS缓存
+ 查询本机DNS缓存，常见host文件
+ 查询本地路由器DNS缓存
+ 查询ISP(互联网服务提供商,例如电信,移动)中的DNS服务器
+ 查询根域名服务器，判断是否有目标域名的信息,如果没有,则传至子域名服务器进行查询，以此递推 

# 信息传递

说到数据在不同网络不同计算机中传输必须就要说到TCP/IP协议族了，可以说计算机能安全、准确完成网际通信全靠这个。根据TCP/IP协议族分层思想，可以按照自上而下的层级关系可表示为：应用层、传输层、网络层、链路层。

从客户端向服务器端发起请求，信息传递的过程大致如下：

+ 从浏览器端所在的应用层会得到需要请求的数据，如HTTP报文
+ 经过TCP协议所在的传输层会加一层TCP首部，保证数据的可靠性
+ 经过IP协议所在的网络层会加一层IP首部，确保数据的可传输性
+ 经过链路层则会加一层以太首部，保证数据在硬件中正确传输

这是一个数据封装的过程，而服务器端获取数据会有相对应的从下而上的解封过程。

值得一提的是，在进行数据流向服务器端正式传输之前，常用的有TCP的三次握手方式建立网络连接，有兴趣的可以去了解一下三次握手的具体过程。

# 页面生成

当从服务器中获取到原始数据（通常为HTML文件）后，浏览器需要以网页的形式展现给用户，在此之前需要做的操作就是视图解析的操作过程。

![视图解析](/images/html-generate.jpg)

常规来说，HTML文档解析是一个阻塞式的过程，不考虑页面内存在SVG或者XHTML的情况，单纯HTML文件来说可以简单概括为如下步骤：

1. DOM Tree生成
2. CSS Rule Tree生成
3. 合并DOM Tree和CSS Rule Tree，构造Rendering Tree，该过程比较消耗性能，简易DOM小，CSS避免嵌套
4. 调用操作系统GUI的API开始渲染

# 总结

严格来说这个问题涉及前端、网络、后台、运维、浏览器工作原理等等相关知识，暂时浅尝，特别是视图解析的部分，作为一名前端开发还是有必要对自己的工作环境——浏览器——有所了解的，所以并不辄止，后期会跟进相关知识点的补充。
